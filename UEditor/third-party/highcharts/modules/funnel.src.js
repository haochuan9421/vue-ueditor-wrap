/*! For license information please see funnel.src.js.LICENSE.txt */
!function(t){"use strict";var e=t.getOptions().plotOptions,n=t.seriesTypes,a=t.merge,o=function(){},i=t.each;e.funnel=a(e.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}}),n.funnel=t.extendClass(n.pie,{type:"funnel",animate:o,translate:function(){var t,e,n,a,r,s,h,l,c,p,d,u=function(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)},f=0,g=this,b=g.chart,w=b.plotWidth,y=b.plotHeight,C=0,L=g.options,k=L.center,W=u(k[0],w),v=u(k[0],y),A=u(L.width,w),H=u(L.height,y),P=u(L.neckWidth,w),X=u(L.neckHeight,y),m=H-X,T=g.data,Y="left"===L.dataLabels.position?1:0;g.getWidthAt=e=function(t){return t>H-X||H===X?P:P+(H-X-t)/(H-X)*(A-P)},g.getX=function(t,n){return W+(n?-1:1)*(e(t)/2+L.dataLabels.distance)},g.center=[W,v,H],g.centerX=W,i(T,(function(t){f+=t.y})),i(T,(function(i){d=null,a=f?i.y/f:0,c=(s=v-H/2+C*H)+a*H,t=e(s),h=(r=W-t/2)+t,t=e(c),p=(l=W-t/2)+t,s>m?(r=l=W-P/2,h=p=W+P/2):c>m&&(d=c,t=e(m),p=(l=W-t/2)+t,c=m),n=["M",r,s,"L",h,s,p,c],d&&n.push(p,d,l,d),n.push(l,c,"Z"),i.shapeType="path",i.shapeArgs={d:n},i.percentage=100*a,i.plotX=W,i.plotY=(s+(d||c))/2,i.tooltipPos=[W,i.plotY],i.slice=o,i.half=Y,C+=a})),g.setTooltipPoints()},drawPoints:function(){var t=this,e=t.options,n=t.chart.renderer;i(t.data,(function(a){var o=a.graphic,i=a.shapeArgs;o?o.animate(i):a.graphic=n.path(i).attr({fill:a.color,stroke:e.borderColor,"stroke-width":e.borderWidth}).add(t.group)}))},sortByAngle:o,drawDataLabels:function(){var t,e,a,o,i,r=this.data,s=this.options.dataLabels.distance,h=r.length;for(this.center[2]-=2*s;h--;)e=(t=(a=r[h]).half)?1:-1,i=a.plotY,o=this.getX(i,t),a.labelPos=[0,i,o+(s-5)*e,i,o+s*e,i,t?"right":"left",0];n.pie.prototype.drawDataLabels.call(this)}})}(Highcharts);